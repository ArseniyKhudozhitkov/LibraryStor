<Page x:Class="Library.Views.ManageBooksPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Управление книгами" 
      Background="#FFFFFF"
      Loaded="Page_Loaded">

    <Page.Resources>
        <Style TargetType="Button">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Margin" Value="2"/>
            <Setter Property="Background" Value="#00FA9A"/>
        </Style>
        <Style TargetType="TextBox">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Padding" Value="4"/>
            <Setter Property="Margin" Value="2"/>
        </Style>
        <Style TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="5,0"/>
        </Style>
    </Page.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" 
                  Text="Управление книгами" 
                  FontSize="20" 
                  FontWeight="Bold" 
                  Margin="10,5"
                  HorizontalAlignment="Center"/>

        <Border Grid.Row="1" 
               BorderBrush="#00FA9A" 
               BorderThickness="1" 
               Margin="10" 
               Padding="10"
               Background="#F0FFF0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="Название:"/>
                <TextBox Grid.Row="0" Grid.Column="1" x:Name="txtTitle" Width="150"/>

                <TextBlock Grid.Row="0" Grid.Column="2" Text="Автор:"/>
                <TextBox Grid.Row="0" Grid.Column="3" x:Name="txtAuthor" Width="120"/>

                <TextBlock Grid.Row="0" Grid.Column="4" Text="Жанр:"/>
                <TextBox Grid.Row="0" Grid.Column="5" x:Name="txtGenre" Width="100"/>

                <TextBlock Grid.Row="0" Grid.Column="6" Text="Цена:"/>
                <TextBox Grid.Row="0" Grid.Column="7" x:Name="txtPrice" Width="80"/>

                <TextBlock Grid.Row="1" Grid.Column="0" Text="Количество:"/>
                <TextBox Grid.Row="1" Grid.Column="1" x:Name="txtQuantity" Width="80"/>

                <TextBlock Grid.Row="1" Grid.Column="2" Text="Скидка (%):"/>
                <TextBox Grid.Row="1" Grid.Column="3" x:Name="txtDiscount" Width="60"/>

                <StackPanel Grid.Row="1" Grid.Column="4" Grid.ColumnSpan="5" 
                           Orientation="Horizontal" 
                           HorizontalAlignment="Right">
                    <Button Content="Добавить" Click="AddButton_Click" Background="#7FFF00"/>
                    <Button Content="Сохранить" Click="SaveButton_Click" x:Name="btnSave"/>
                    <Button Content="Отменить" Click="CancelButton_Click" Background="#FFA07A"/>
                </StackPanel>
            </Grid>
        </Border>

        <DataGrid Grid.Row="2" 
                 x:Name="booksGrid" 
                 AutoGenerateColumns="False" 
                 IsReadOnly="True"
                 Margin="10"
                 SelectionChanged="booksGrid_SelectionChanged">
            <DataGrid.Columns>
                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="40"/>
                <DataGridTextColumn Header="Название" Binding="{Binding Title}" Width="200"/>
                <DataGridTextColumn Header="Автор" Binding="{Binding Author}" Width="150"/>
                <DataGridTextColumn Header="Жанр" Binding="{Binding Genre}" Width="100"/>
                <DataGridTextColumn Header="Цена" Binding="{Binding Price, StringFormat={}{0}₽}" Width="80"/>
                <DataGridTextColumn Header="Количество" Binding="{Binding Quantity}" Width="80"/>
                <DataGridTextColumn Header="Скидка" Binding="{Binding Discount, StringFormat={}{0}%}" Width="70"/>
                <DataGridTextColumn Header="Итоговая цена" Binding="{Binding FinalPrice, StringFormat={}{0}₽}" Width="100"/>
                <DataGridTemplateColumn Header="Действия" Width="150">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <Button Content="✏️" 
                                       ToolTip="Редактировать" 
                                       Click="EditButton_Click"
                                       Background="Transparent" 
                                       BorderThickness="0"
                                       FontSize="14"/>
                                <Button Content="❌" 
                                       ToolTip="Удалить" 
                                       Click="DeleteButton_Click"
                                       Background="Transparent" 
                                       BorderThickness="0"
                                       FontSize="14"
                                       Margin="5,0,0,0"/>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>


        <StatusBar Grid.Row="3" Background="#7FFF00">
            <TextBlock x:Name="statusText" Text="Готов к работе"/>
        </StatusBar>
    </Grid>
</Page>